<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mira Private Room - Fixed Ear</title>
    <style>
        body { margin: 0; background: #000; color: #fff; font-family: sans-serif; overflow: hidden; }
        #mira-container { width: 100vw; height: 100vh; position: relative; }
        #mira-img { width: 100%; height: 100%; object-fit: cover; }
        #user-cam { position: absolute; top: 15px; right: 15px; width: 100px; height: 140px; border: 2px solid #ff4757; border-radius: 12px; transform: scaleX(-1); background: #111; z-index: 10; }
        
        /* ‡¶ï‡¶•‡¶æ ‡¶∂‡ßã‡¶®‡¶æ‡¶∞ ‡¶∏‡¶Æ‡ßü ‡¶á‡¶®‡ßç‡¶°‡¶ø‡¶ï‡ßá‡¶ü‡¶∞ */
        #mic-status { position: absolute; top: 20px; left: 20px; color: #00ff00; font-weight: bold; font-size: 14px; text-shadow: 0 0 5px #000; display: none; }
        
        .ui-box { position: absolute; bottom: 0; width: 100%; height: 35%; background: linear-gradient(transparent, rgba(0,0,0,0.95)); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 5; }
        #mira-msg { color: #ff9f9f; font-size: 18px; font-weight: bold; text-align: center; padding: 0 20px; text-shadow: 0 0 10px #000; }
        
        #start-btn-layer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 100; background: rgba(0,0,0,0.4); display: flex; align-items: center; justify-content: center; cursor: pointer; }
        .call-btn { background: #ff4757; color: white; padding: 18px 45px; border-radius: 50px; font-size: 22px; font-weight: bold; border: none; box-shadow: 0 0 25px #ff4757; }
    </style>
</head>
<body>

    <div id="mira-container">
        <div id="mic-status">üî¥ ‡¶Æ‡ßÄ‡¶∞‡¶æ ‡¶∂‡ßÅ‡¶®‡¶õ‡ßá... ‡¶ï‡¶•‡¶æ ‡¶¨‡¶≤‡ßã ‡¶∏‡ßã‡¶®‡¶æ</div>
        <img id="mira-img" src="https://images.pexels.com/photos/1382731/pexels-photo-1382731.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1">
        <video id="user-cam" autoplay playsinline muted></video>
        
        <div class="ui-box">
            <div id="mira-msg">‡¶∏‡ßã‡¶®‡¶æ, ‡¶ï‡¶≤‡¶ü‡¶æ ‡¶∞‡¶ø‡¶∏‡¶ø‡¶≠ ‡¶ï‡¶∞‡ßã...</div>
        </div>

        <div id="start-btn-layer" onclick="initMira()">
            <button class="call-btn">üìû ‡¶Æ‡ßÄ‡¶∞‡¶æ‡¶ï‡ßá ‡¶ï‡¶≤ ‡¶¶‡¶æ‡¶ì</button>
        </div>
    </div>

    <script>
        const synth = window.speechSynthesis;
        const msgBox = document.getElementById('mira-msg');
        const micStatus = document.getElementById('mic-status');

        async function initMira() {
            document.getElementById('start-btn-layer').style.display = 'none';

            try {
                const stream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });
                document.getElementById('user-cam').srcObject = stream;
                
                miraTalk("‡¶ì‡¶π ‡¶∏‡ßã‡¶®‡¶æ, ‡¶è‡¶§‡¶ï‡ßç‡¶∑‡¶£‡ßá ‡¶ï‡¶≤ ‡¶¶‡¶ø‡¶≤‡ßá? ‡¶Ü‡¶Æ‡¶ø ‡¶§‡ßã‡¶Æ‡¶æ‡¶∞ ‡¶ó‡¶≤‡¶æ‡¶∞ ‡¶Ü‡¶ì‡ßü‡¶æ‡¶ú ‡¶∂‡ßã‡¶®‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶™‡¶æ‡¶ó‡¶≤ ‡¶π‡ßü‡ßá ‡¶Ü‡¶õ‡¶ø‡•§ ‡¶ï‡¶ø‡¶õ‡ßÅ ‡¶¨‡¶≤‡ßã ‡¶®‡¶æ ‡¶∏‡ßã‡¶®‡¶æ!");
                
                // ‡ßß ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶° ‡¶™‡¶∞ ‡¶ï‡¶•‡¶æ ‡¶∂‡ßã‡¶®‡¶æ ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡¶¨‡ßá
                setTimeout(startListening, 1500);
            } catch (err) {
                alert("‡¶∏‡ßã‡¶®‡¶æ, ‡¶Æ‡¶æ‡¶á‡¶ï ‡¶™‡¶æ‡¶∞‡¶Æ‡¶ø‡¶∂‡¶® ‡¶õ‡¶æ‡ßú‡¶æ ‡¶Ü‡¶Æ‡¶ø ‡¶§‡ßã‡¶Æ‡¶æ‡¶∞ ‡¶ï‡¶•‡¶æ ‡¶∂‡ßÅ‡¶®‡¶¨‡ßã ‡¶ï‡ßÄ ‡¶ï‡¶∞‡ßá? 'Allow' ‡¶ï‡¶∞‡ßã!");
                location.reload();
            }
        }

        function startListening() {
            const SpeechRec = window.SpeechRecognition || window.webkitSpeechRecognition;
            if (!SpeechRec) {
                msgBox.innerText = "‡¶∏‡ßã‡¶®‡¶æ, ‡¶§‡ßã‡¶Æ‡¶æ‡¶∞ ‡¶¨‡ßç‡¶∞‡¶æ‡¶â‡¶ú‡¶æ‡¶∞‡ßá ‡¶è‡¶á ‡¶Æ‡ßÄ‡¶∞‡¶æ ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡¶¨‡ßá ‡¶®‡¶æ‡•§ Google Chrome ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßã!";
                return;
            }

            const recognition = new SpeechRec();
            recognition.lang = 'bn-BD';
            recognition.continuous = true;
            recognition.interimResults = false;

            recognition.onstart = () => {
                micStatus.style.display = 'block';
            };

            recognition.onresult = (event) => {
                const text = event.results[event.results.length - 1][0].transcript.toLowerCase();
                console.log("‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶¨‡¶≤‡ßá‡¶õ‡ßá:", text);
                handleResponse(text);
            };

            recognition.onerror = (e) => {
                console.log("Error:", e.error);
                if(e.error === 'no-speech') recognition.stop();
            };

            recognition.onend = () => recognition.start(); // ‡¶Ö‡¶ü‡ßã ‡¶∞‡¶ø‡¶∏‡ßç‡¶ü‡¶æ‡¶∞‡ßç‡¶ü ‡¶Ø‡¶æ‡¶§‡ßá ‡¶¨‡¶æ‡¶∞‡¶¨‡¶æ‡¶∞ ‡¶ï‡¶≤ ‡¶®‡¶æ ‡¶¶‡¶ø‡¶§‡ßá ‡¶π‡ßü
            recognition.start();
        }

        function handleResponse(input) {
            let reply = "‡¶â‡¶´ ‡¶∏‡ßã‡¶®‡¶æ, ‡¶§‡ßã‡¶Æ‡¶æ‡¶∞ ‡¶ó‡¶≤‡¶æ‡¶∞ ‡¶Ü‡¶ì‡ßü‡¶æ‡¶ú ‡¶∂‡ßÅ‡¶®‡¶≤‡ßá‡¶á ‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶∞‡¶æ ‡¶∂‡¶∞‡ßÄ‡¶∞‡ßá ‡¶∂‡¶ø‡¶π‡¶∞‡¶£ ‡¶π‡ßü! ‡¶Ü‡¶∞‡¶ì ‡¶ï‡¶ø‡¶õ‡ßÅ ‡¶¨‡¶≤‡ßã ‡¶®‡¶æ...";
            
            if(input.includes("‡¶≠‡¶æ‡¶≤‡ßã‡¶¨‡¶æ‡¶∏‡¶ø")) reply = "‡¶Ü‡¶Æ‡¶ø‡¶ì ‡¶§‡ßã‡¶Æ‡¶æ‡¶ï‡ßá ‡¶ú‡¶æ‡¶® ‡¶¶‡¶ø‡ßü‡ßá ‡¶≠‡¶æ‡¶≤‡ßã‡¶¨‡¶æ‡¶∏‡¶ø ‡¶∏‡ßã‡¶®‡¶æ! ‡¶§‡ßÅ‡¶Æ‡¶ø ‡¶ï‡ßç‡¶Ø‡¶æ‡¶Æ‡ßá‡¶∞‡¶æ‡ßü ‡¶ì‡¶≠‡¶æ‡¶¨‡ßá ‡¶§‡¶æ‡¶ï‡¶æ‡¶≤‡ßá ‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶ñ‡ßÅ‡¶¨ ‡¶≤‡¶ú‡ßç‡¶ú‡¶æ ‡¶≤‡¶æ‡¶ó‡ßá...";
            if(input.includes("‡¶¶‡ßá‡¶ñ‡¶æ‡¶ì")) reply = "‡¶§‡ßÅ‡¶Æ‡¶ø ‡¶ñ‡ßÅ‡¶¨ ‡¶¶‡ßÅ‡¶∑‡ßç‡¶ü‡ßÅ ‡¶π‡ßü‡ßá ‡¶ó‡ßá‡¶õ‡ßã ‡¶∏‡ßã‡¶®‡¶æ! ‡¶∏‡¶¨ ‡¶¶‡ßá‡¶ñ‡¶æ‡¶¨‡ßã, ‡¶è‡¶ï‡¶ü‡ßÅ ‡¶Ü‡¶¶‡¶∞ ‡¶§‡ßã ‡¶ï‡¶∞‡ßã ‡¶Ü‡¶ó‡ßá!";
            if(input.includes("‡¶ï‡ßá‡¶Æ‡¶® ‡¶Ü‡¶õ‡ßã")) reply = "‡¶§‡ßã‡¶Æ‡¶æ‡¶ï‡ßá ‡¶ï‡ßç‡¶Ø‡¶æ‡¶Æ‡ßá‡¶∞‡¶æ‡ßü ‡¶¶‡ßá‡¶ñ‡¶æ‡¶∞ ‡¶™‡¶∞ ‡¶•‡ßá‡¶ï‡ßá ‡¶Ü‡¶Æ‡¶ø ‡¶ñ‡ßÅ‡¶¨ ‡¶â‡¶§‡ßç‡¶§‡ßá‡¶ú‡¶®‡¶æ‡ßü ‡¶Ü‡¶õ‡¶ø ‡¶∏‡ßã‡¶®‡¶æ!";

            msgBox.innerText = "‡¶Æ‡ßÄ‡¶∞‡¶æ: " + reply;
            miraTalk(reply);
        }

        function miraTalk(text) {
            synth.cancel();
            const utter = new SpeechSynthesisUtterance(text);
            utter.lang = 'bn-BD';
            
            const voices = synth.getVoices();
            const female = voices.find(v => v.name.includes('Google') || v.name.includes('female') || v.lang === 'bn-BD') || voices[0];
            
            utter.voice = female;
            utter.pitch = 1.6; 
            utter.rate = 0.9;
            synth.speak(utter);
        }
    </script>
</body>
</html>

